<?xml version="1.0" encoding="UTF-8"?>

<pageSetting id="lcyjfp" title="理财业绩分配" type="yjgx" version="2.0.0"> 
  <mainPage> 
    <tags> 
      <tag name="Date" fieldName="JXDX_LCJYLS.JYRQ" condition="between ? and 1" col="0" row="0" colspan="1" label="交易日期"> 
        <attribute key="label" value="交易日期"/>  
        <attribute key="name" value="QSRQ"/>  
        <attribute key="dateFmt" value="yyyyMMdd"/>  
        <attribute key="defValType" value="yc"/>  
        <attribute key="styleClass" value=""/>  
        <attribute key="defVal" value=""/>  
        <attribute key="style" value=""/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag name="Date" fieldName="JXDX_LCJYLS.JYRQ" condition="between 1 and ?" col="1" row="0" colspan="1" label="到"> 
        <attribute key="label" value="到"/>  
        <attribute key="name" value="JSRQ"/>  
        <attribute key="dateFmt" value="yyyyMMdd"/>  
        <attribute key="defValType" value="sysDate"/>  
        <attribute key="styleClass" value=""/>  
        <attribute key="defVal" value=""/>  
        <attribute key="style" value=""/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag name="NewJg" fieldName="JXDX_LCJYLS.JGDH" condition="in" col="2" row="0" colspan="1" label="交易机构"> 
        <attribute key="label" value="交易机构"/>  
        <attribute key="name" value="JGKHDXDH"/>  
        <attribute key="ckbz" value="jg_ckhy"/>  
        <attribute key="multiple" value="false"/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="style" value=""/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag name="Text" fieldName="JXDX_LCJYLS.ZHDH" condition="like %?%" col="0" row="1" colspan="1" label="账号"> 
        <attribute key="label" value="账号"/>  
        <attribute key="name" value="ZHDH"/>  
        <attribute key="value" value=""/>  
        <attribute key="maxlength" value=""/>  
        <attribute key="readonly" value="false"/>  
        <attribute key="style" value=""/>  
        <attribute key="styleClass" value=""/>  
        <attribute key="editable" value="true"/> 
      </tag> 
    </tags>  
    <javascript/> 
  </mainPage>  
  <listPage> 
    <tags> 
      <tag name="Label" fieldName="LSH" condition="=" col="0" row="0" colspan="1" label="流水号"> 
        <attribute key="label" value="流水号"/>  
        <attribute key="name" value="LSH"/> 
      </tag>  
      <tag name="Label" fieldName="ZHDH" condition="=" col="1" row="0" colspan="1" label="账号"> 
        <attribute key="label" value="账号"/>  
        <attribute key="name" value="ZHDH"/> 
      </tag> 
    </tags>  
    <javascript/> 
  </listPage>  
  <table page="true" id="lcyjfp_table_main"> 
    <col id="LSH" title="流水号" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="JYRQ" title="交易日期" align="left" type="string" width="80" format="" frozen="" exp="true"/>  
    <col id="JGMC" title="交易机构" align="left" type="string" width="150" format="" frozen="" exp="true"/>  
    <col id="ZHDH" title="账号" align="left" type="string" width="150" format="" frozen="" exp="true"/>  
    <col id="KHH" title="客户号" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="CPDM" title="产品代码" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="CPMC" title="产品名称" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="CPQX" title="产品期限" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="SHRQ" title="赎回日期" align="left" type="string" width="120" format="" frozen="" exp="true"/>  
    <col id="DQFPGX" title="当前分配关系" align="left" type="string" width="200" format="" frozen="" exp="true"/>  
    <col id="BZZWMC" title="币种" align="left" type="string" width="100" format="" frozen="" exp="true"/>  
    <col id="JYJE" title="交易金额" align="right" type="float" width="100" format="" frozen="" exp="true"/>  
    <col id="JYFS" title="交易份数" align="right" type="float" width="120" format="" frozen="" exp="true"/> 
  </table>  
  <table page="true" id="lcyjfp_table_list"> 
    <col id="JGDH" title="机构代号" align="left" type="string" width="100" format="" frozen=""/>  
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" format="" frozen=""/>  
    <col id="HYDH" title="行员代号" align="left" type="string" width="80" format="" frozen=""/>  
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" format="" frozen=""/>  
    <col id="QSRQ" title="起始日期" align="left" type="string" width="80" format="" frozen=""/>  
    <col id="JSRQ" title="结束日期" align="left" type="string" width="80" format="" frozen=""/>  
    <col id="ZLBL" title="分配比例" align="right" type="float" width="80" format="" frozen=""/>  
    <col id="LSH" title="lsh1" align="right" type="hidden" width="180" format="true" frozen="false" hidden="true"/>  
    <col id="JYRQ" title="jyrq2" align="right" type="hidden" width="180" format="true" frozen="false" hidden="true"/> 
  </table>  
  <rels> 
    <items id="lcyjfp_table_main"> 
      <item name="hideZd" compareValue="main" operate="isEqual"/> 
    </items>  
    <items id="lcyjfp_table_list"> 
      <item name="hideZd" compareValue="list" operate="isEqual"/> 
    </items> 
  </rels>  
  <performance> 
    <primaryKey>LSH</primaryKey>  
    <primaryKey>JYRQ</primaryKey> 
  </performance>  
  <sqlMap> 
    <select id="dn1.lcyjfp_select_validateDate" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from JXDX_LCJYLS JXDX_LCJYLS where 1=1 and JXDX_LCJYLS.LSH = '$LSH$' and JXDX_LCJYLS.JYRQ = $JYRQ$ and JYRQ &gt; $QSRQ$
    </select>  
    <select id="dn1.lcyjfp_select_maxQsrq" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select max(qsrq) from dxgx_yjgx_lc where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$
    </select>  
    <select id="dn1.lcyjfp_select_khrq" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select JYRQ from JXDX_LCJYLS where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$
    </select>  
    <select id="dn1.lcyjfp_select_minQsrq" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select min(qsrq) from dxgx_yjgx_lc gx where 1=1 and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$
    </select>  
    <select id="dn1.lcyjfp_select_mainPage_db2" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select CSB_BZ787.BZZWMC as BZZWMC,JXDX_LCJYLS.JYFS as JYFS,JXDX_LCJYLS.JYRQ as JYRQ,JXDX_LCJYLS.LSH as LSH,JXDX_LCJYLS.CPDM as CPDM,JXDX_LCJYLS.ZHDH as ZHDH,JXDX_LCJYLS.SHRQ as SHRQ,JXDX_LCJYLS.CPQX as CPQX,JXDX_LCJYLS.JYJE as JYJE,JXDX_LCCPXX.CPMC as CPMC,JXDX_LCJYLS.KHH as KHH,KHDX_JG180.JGMC as JGMC, case when coalesce(max(dxgx_yjgx_lc.zlbl),0) = 0 then '无关系' when max(dxgx_yjgx_lc.zlbl)=100 then max(khdx_hy.hymc)||'|100' else cast('百分比:'||replace(replace(xml2clob(xmlagg(xmlelement(name a, khdx_hy.hymc||'|'||f_numtochar(dxgx_yjgx_lc.zlbl)||','))),'&lt;A&gt;',''),'&lt;/A&gt;',' ') as varchar(200)) end as DQFPGX from JXDX_LCJYLS JXDX_LCJYLS left outer join dxgx_yjgx_lc dxgx_yjgx_lc on 1=1 and dxgx_yjgx_lc.LSH=JXDX_LCJYLS.LSH and dxgx_yjgx_lc.JYRQ=JXDX_LCJYLS.JYRQ and $sysdate$ between dxgx_yjgx_lc.qsrq and dxgx_yjgx_lc.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_LCJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH inner join CSB_BZ CSB_BZ787 on CSB_BZ787.BZ=JXDX_LCJYLS.BZ inner join JXDX_LCCPXX JXDX_LCCPXX on JXDX_LCCPXX.CPDM=JXDX_LCJYLS.CPDM where 1=1
      <isNotEmpty property="ZHDH">and JXDX_LCJYLS.ZHDH like '%$ZHDH$%'</isNotEmpty>  
      <isNotEmpty property="JSRQ"> 
        <isEmpty property="QSRQ">and JXDX_LCJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isNotEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty> 
      </isNotEmpty> group by CSB_BZ787.BZZWMC,JXDX_LCJYLS.JYFS,JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH,JXDX_LCJYLS.CPDM,JXDX_LCJYLS.ZHDH,JXDX_LCJYLS.SHRQ,JXDX_LCJYLS.CPQX,JXDX_LCJYLS.JYJE,JXDX_LCCPXX.CPMC,JXDX_LCJYLS.KHH,KHDX_JG180.JGMC order by JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH
    </select>  
    <select id="dn1.lcyjfp_select_mainPage_ora" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select CSB_BZ787.BZZWMC as BZZWMC,JXDX_LCJYLS.JYFS as JYFS,JXDX_LCJYLS.JYRQ as JYRQ,JXDX_LCJYLS.LSH as LSH,JXDX_LCJYLS.CPDM as CPDM,JXDX_LCJYLS.ZHDH as ZHDH,JXDX_LCJYLS.SHRQ as SHRQ,JXDX_LCJYLS.CPQX as CPQX,JXDX_LCJYLS.JYJE as JYJE,JXDX_LCCPXX.CPMC as CPMC,JXDX_LCJYLS.KHH as KHH,KHDX_JG180.JGMC as JGMC, F_WM_CONCAT(khdx_hy.hymc || dxgx_yjgx_lc.zlbl) DQFPGX from JXDX_LCJYLS JXDX_LCJYLS left outer join dxgx_yjgx_lc dxgx_yjgx_lc on 1=1 and dxgx_yjgx_lc.LSH=JXDX_LCJYLS.LSH and dxgx_yjgx_lc.JYRQ=JXDX_LCJYLS.JYRQ and $sysdate$ between dxgx_yjgx_lc.qsrq and dxgx_yjgx_lc.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_LCJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH inner join CSB_BZ CSB_BZ787 on CSB_BZ787.BZ=JXDX_LCJYLS.BZ inner join JXDX_LCCPXX JXDX_LCCPXX on JXDX_LCCPXX.CPDM=JXDX_LCJYLS.CPDM where 1=1 
      <isNotEmpty property="ZHDH">and JXDX_LCJYLS.ZHDH like '%$ZHDH$%'</isNotEmpty>  
      <isNotEmpty property="JSRQ"> 
        <isEmpty property="QSRQ">and JXDX_LCJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isNotEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty> 
      </isNotEmpty> group by CSB_BZ787.BZZWMC,JXDX_LCJYLS.JYFS,JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH,JXDX_LCJYLS.CPDM,JXDX_LCJYLS.ZHDH,JXDX_LCJYLS.SHRQ,JXDX_LCJYLS.CPQX,JXDX_LCJYLS.JYJE,JXDX_LCCPXX.CPMC,JXDX_LCJYLS.KHH,KHDX_JG180.JGMC order by JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH
    </select>  
    <select id="dn1.lcyjfp_select_mainCount_db2" parameterClass="java.util.Map" resultClass="java.lang.Integer" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from (select CSB_BZ787.BZZWMC as BZZWMC,JXDX_LCJYLS.JYFS as JYFS,JXDX_LCJYLS.JYRQ as JYRQ,JXDX_LCJYLS.LSH as LSH,JXDX_LCJYLS.CPDM as CPDM,JXDX_LCJYLS.ZHDH as ZHDH,JXDX_LCJYLS.SHRQ as SHRQ,JXDX_LCJYLS.CPQX as CPQX,JXDX_LCJYLS.JYJE as JYJE,JXDX_LCCPXX.CPMC as CPMC,JXDX_LCJYLS.KHH as KHH,KHDX_JG180.JGMC as JGMC, case when coalesce(max(dxgx_yjgx_lc.zlbl),0) = 0 then '无关系' when max(dxgx_yjgx_lc.zlbl)=100 then max(khdx_hy.hymc)||'|100' else cast('百分比:'||replace(replace(xml2clob(xmlagg(xmlelement(name a, khdx_hy.hymc||'|'||f_numtochar(dxgx_yjgx_lc.zlbl)||','))),'&lt;A&gt;',''),'&lt;/A&gt;',' ') as varchar(200)) end as DQFPGX from JXDX_LCJYLS JXDX_LCJYLS left outer join dxgx_yjgx_lc dxgx_yjgx_lc on 1=1 and dxgx_yjgx_lc.LSH=JXDX_LCJYLS.LSH and dxgx_yjgx_lc.JYRQ=JXDX_LCJYLS.JYRQ and $sysdate$ between dxgx_yjgx_lc.qsrq and dxgx_yjgx_lc.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_LCJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH inner join CSB_BZ CSB_BZ787 on CSB_BZ787.BZ=JXDX_LCJYLS.BZ inner join JXDX_LCCPXX JXDX_LCCPXX on JXDX_LCCPXX.CPDM=JXDX_LCJYLS.CPDM where 1=1
      <isNotEmpty property="ZHDH">and JXDX_LCJYLS.ZHDH like '%$ZHDH$%'</isNotEmpty>  
      <isNotEmpty property="JSRQ"> 
        <isEmpty property="QSRQ">and JXDX_LCJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isNotEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty> 
      </isNotEmpty> group by CSB_BZ787.BZZWMC,JXDX_LCJYLS.JYFS,JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH,JXDX_LCJYLS.CPDM,JXDX_LCJYLS.ZHDH,JXDX_LCJYLS.SHRQ,JXDX_LCJYLS.CPQX,JXDX_LCJYLS.JYJE,JXDX_LCCPXX.CPMC,JXDX_LCJYLS.KHH,KHDX_JG180.JGMC order by JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH) count
    </select>  
    <select id="dn1.lcyjfp_select_mainCount_ora" parameterClass="java.util.Map" resultClass="java.lang.Integer" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from (select CSB_BZ787.BZZWMC as BZZWMC,JXDX_LCJYLS.JYFS as JYFS,JXDX_LCJYLS.JYRQ as JYRQ,JXDX_LCJYLS.LSH as LSH,JXDX_LCJYLS.CPDM as CPDM,JXDX_LCJYLS.ZHDH as ZHDH,JXDX_LCJYLS.SHRQ as SHRQ,JXDX_LCJYLS.CPQX as CPQX,JXDX_LCJYLS.JYJE as JYJE,JXDX_LCCPXX.CPMC as CPMC,JXDX_LCJYLS.KHH as KHH,KHDX_JG180.JGMC as JGMC, F_WM_CONCAT(khdx_hy.hymc || dxgx_yjgx_lc.zlbl) DQFPGX from JXDX_LCJYLS JXDX_LCJYLS left outer join dxgx_yjgx_lc dxgx_yjgx_lc on 1=1 and dxgx_yjgx_lc.LSH=JXDX_LCJYLS.LSH and dxgx_yjgx_lc.JYRQ=JXDX_LCJYLS.JYRQ and $sysdate$ between dxgx_yjgx_lc.qsrq and dxgx_yjgx_lc.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_LCJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH inner join CSB_BZ CSB_BZ787 on CSB_BZ787.BZ=JXDX_LCJYLS.BZ inner join JXDX_LCCPXX JXDX_LCCPXX on JXDX_LCCPXX.CPDM=JXDX_LCJYLS.CPDM where 1=1 
      <isNotEmpty property="ZHDH">and JXDX_LCJYLS.ZHDH like '%$ZHDH$%'</isNotEmpty>  
      <isNotEmpty property="JSRQ"> 
        <isEmpty property="QSRQ">and JXDX_LCJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty> 
      </isNotEmpty>  
      <isNotEmpty property="QSRQ"> 
        <isNotEmpty property="JSRQ">and JXDX_LCJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty> 
      </isNotEmpty> group by CSB_BZ787.BZZWMC,JXDX_LCJYLS.JYFS,JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH,JXDX_LCJYLS.CPDM,JXDX_LCJYLS.ZHDH,JXDX_LCJYLS.SHRQ,JXDX_LCJYLS.CPQX,JXDX_LCJYLS.JYJE,JXDX_LCCPXX.CPMC,JXDX_LCJYLS.KHH,KHDX_JG180.JGMC order by JXDX_LCJYLS.JYRQ,JXDX_LCJYLS.LSH) count
    </select>  
    <select id="dn1.lcyjfp_select_gxmxPage" parameterClass="java.util.Map" resultClass="java.util.HashMap"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select distinct khdx_jg.JGDH as JGDH,khdx_hy.HYMC as HYMC,JXDX_LCJYLS.LSH,khdx_hy.HYDH as HYDH,DXGX_YJGX_LC.QSRQ as QSRQ,JXDX_LCJYLS.JYRQ,DXGX_YJGX_LC.JSRQ as JSRQ,KHDX_JG.JGMC as JGMC,DXGX_YJGX_LC.ZLBL as ZLBL from dxgx_yjgx_lc dxgx_yjgx_lc inner join JXDX_LCJYLS JXDX_LCJYLS on 1=1 and JXDX_LCJYLS.LSH=dxgx_yjgx_lc.LSH and JXDX_LCJYLS.JYRQ=dxgx_yjgx_lc.JYRQ inner join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jgcy khdx_jgcy on khdx_hy.khdxdh=khdx_jgcy.khdxdh inner join khdx_jg khdx_jg on khdx_jgcy.jgkhdxdh=khdx_jg.khdxdh and $sysdate$ between khdx_jgcy.qsrq and khdx_jgcy.jsrq inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH where 1=1 and dxgx_yjgx_lc.LSH = '$LSH$' and dxgx_yjgx_lc.JYRQ = $JYRQ$ order by dxgx_yjgx_lc.qsrq
    </select>  
    <select id="dn1.lcyjfp_select_gxmxCount" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from (select distinct khdx_jg.JGDH as JGDH,khdx_hy.HYMC as HYMC,JXDX_LCJYLS.LSH,khdx_hy.HYDH as HYDH,DXGX_YJGX_LC.QSRQ as QSRQ,JXDX_LCJYLS.JYRQ,DXGX_YJGX_LC.JSRQ as JSRQ,KHDX_JG.JGMC as JGMC,DXGX_YJGX_LC.ZLBL as ZLBL from dxgx_yjgx_lc dxgx_yjgx_lc inner join JXDX_LCJYLS JXDX_LCJYLS on 1=1 and JXDX_LCJYLS.LSH=dxgx_yjgx_lc.LSH and JXDX_LCJYLS.JYRQ=dxgx_yjgx_lc.JYRQ inner join khdx_hy khdx_hy on dxgx_yjgx_lc.khdxdh=khdx_hy.khdxdh inner join khdx_jgcy khdx_jgcy on khdx_hy.khdxdh=khdx_jgcy.khdxdh inner join khdx_jg khdx_jg on khdx_jgcy.jgkhdxdh=khdx_jg.khdxdh and $sysdate$ between khdx_jgcy.qsrq and khdx_jgcy.jsrq inner join KHDX_JG KHDX_JG180 on KHDX_JG180.JGDH=JXDX_LCJYLS.JGDH where 1=1 and dxgx_yjgx_lc.LSH = '$LSH$' and dxgx_yjgx_lc.JYRQ = $JYRQ$ order by dxgx_yjgx_lc.qsrq) a
    </select>  
    <delete id="dn1.lcyjfp_delete_last_yjgx" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> delete from dxgx_yjgx_lc where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=29991231
    </delete>  
    <update id="dn1.lcyjfp_before_insert_yjgx2" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> update dxgx_yjgx_lc set jsrq=$BEFORE$ where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$ and qsrq=(select max(qsrq) from dxgx_yjgx_lc where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$)
    </update>  
    <insert id="dn1.lcyjfp_before_insert_yjgx" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> update dxgx_yjgx_lc set jsrq=$BEFORE$ where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=29991231
    </insert>  
    <insert id="dn1.lcyjfp_insert_yjgx" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> insert into DXGX_YJGX_LC(JYRQ,LSH,KHDXDH,QSRQ,JSRQ,ZLBL) values($JYRQ$,'$LSH$',$KHDXDH$,$QSRQ$,$JSRQ$,$ZLBL$)
    </insert>  
    <delete id="dn1.lcyjfp_delete_yjgx" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> delete from dxgx_yjgx_lc gx where 1=1 and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$ and gx.jsrq=29991231
    </delete>  
    <update id="dn1.lcyjfp_after_delete_yjgx" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> update dxgx_yjgx_lc set jsrq=29991231 where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=(select max(jsrq) from dxgx_yjgx_lc where 1=1 and LSH = '$LSH$' and JYRQ = $JYRQ$)
    </update>  
    <select id="dn1.lcyjfp_select_maxjldh" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select coalesce(max(jldh),0) from XTB_HYGXRZ_LC
    </select>  
    <insert id="dn1.lcyjfp_insert_gxrz" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> insert into XTB_HYGXRZ_LC(JLDH,JLSJ,CZLX,XGRDH,JYRQ,LSH) values($JLDH$,F_GET_SYSTIME(),'$CZLX$',$XGRDH$,$JYRQ$,'$LSH$')
    </insert>  
    <insert id="dn1.lcyjfp_insert_gxjl" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> insert into XTB_HYGXJL_LC(JLDH,GGBZ,KHDXDH,QSRQ,JSRQ,ZLBL) select $JLDH$,'$GGBZ$',gx.KHDXDH,gx.QSRQ,gx.JSRQ,gx.ZLBL from dxgx_yjgx_lc gx where 1=1 and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$ and jsrq=29991231
    </insert> 
  </sqlMap> 
</pageSetting>
