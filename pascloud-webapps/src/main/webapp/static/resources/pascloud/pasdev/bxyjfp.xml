<?xml version="1.0" encoding="UTF-8"?>
<pageSetting id="bxyjfp" title="保险业绩分配" type="yjgx" version="2.0.0">
  <mainPage>
    <tags>
      <tag name="Date" fieldName="JXDX_BXJYLS.JYRQ" condition="between ? and 1" col="0" row="0" colspan="1" label="交易日期">
        <attribute key="label" value="交易日期" />
        <attribute key="name" value="QSRQ" />
        <attribute key="dateFmt" value="yyyyMMdd" />
        <attribute key="defValType" value="yc" />
        <attribute key="styleClass" value="" />
        <attribute key="defVal" value="" />
        <attribute key="style" value="" />
        <attribute key="isRequired" value="true" />
        <attribute key="editable" value="true" />
      </tag>
      <tag name="Date" fieldName="JXDX_BXJYLS.JYRQ" condition="between 1 and ?" col="1" row="0" colspan="1" label="到">
        <attribute key="label" value="到" />
        <attribute key="name" value="JSRQ" />
        <attribute key="dateFmt" value="yyyyMMdd" />
        <attribute key="defValType" value="sysDate" />
        <attribute key="styleClass" value="" />
        <attribute key="defVal" value="" />
        <attribute key="style" value="" />
        <attribute key="isRequired" value="true" />
        <attribute key="editable" value="true" />
      </tag>
      <tag name="NewJg" fieldName="JXDX_BXJYLS.JGDH" condition="in" col="2" row="0" colspan="1" label="交易机构">
        <attribute key="label" value="交易机构" />
        <attribute key="name" value="JGKHDXDH" />
        <attribute key="ckbz" value="jg_ckhy" />
        <attribute key="multiple" value="false" />
        <attribute key="cascadeCheck" value="true" />
        <attribute key="isRequired" value="true" />
        <attribute key="style" value="" />
        <attribute key="editable" value="true" />
      </tag>
      <tag name="Text" fieldName="JXDX_BXJYLS.BDH" condition="like %?%" col="3" row="0" colspan="1" label="保单号">
        <attribute key="label" value="保单号" />
        <attribute key="name" value="BDH" />
        <attribute key="value" value="" />
        <attribute key="maxlength" value="" />
        <attribute key="readonly" value="false" />
        <attribute key="style" value="" />
        <attribute key="styleClass" value="" />
        <attribute key="editable" value="true" />
      </tag>
    </tags>
    <javascript />
  </mainPage>
  <listPage>
    <tags>
      <tag name="Label" fieldName="LSH" condition="=" col="0" row="0" colspan="1" label="流水号">
        <attribute key="label" value="流水号" />
        <attribute key="name" value="LSH" />
      </tag>
      <tag name="Label" fieldName="JYRQ" condition="=" col="1" row="0" colspan="1" label="交易日期">
        <attribute key="label" value="交易日期" />
        <attribute key="name" value="JYRQ" />
      </tag>
      <tag name="Label" fieldName="BDH" condition="=" col="2" row="0" colspan="1" label="保单号">
        <attribute key="label" value="保单号" />
        <attribute key="name" value="BDH" />
      </tag>
    </tags>
    <javascript />
  </listPage>
  <table page="true" id="bxyjfp_table_main">
    <col id="LSH" title="流水号" align="left" type="string" width="120" format="" frozen="" exp="true" />
    <col id="JYRQ" title="交易日期" align="left" type="string" width="80" format="" frozen="" exp="true" />
    <col id="JGMC" title="交易机构" align="left" type="string" width="150" format="" frozen="" exp="true" />
    <col id="BDH" title="保单号" align="left" type="string" width="120" format="" frozen="" exp="true" />
    <col id="ZHDH" title="账号" align="left" type="string" width="150" format="" frozen="" exp="true" />
    <col id="ZHMC" title="户名" align="left" type="string" width="120" format="" frozen="" exp="true" />
    <col id="KHH" title="客户号" align="left" type="string" width="120" format="" frozen="" exp="true" />
    <col id="DQFPGX" title="当前分配关系" align="left" type="string" width="200" format="" frozen="" exp="true" />
    <col id="CJJE" title="成交金额" align="right" type="float" width="120" format="" frozen="" exp="true" />
    <col id="SXF" title="手续费" align="right" type="float" width="120" format="" frozen="" exp="true" />
  </table>
  <table page="true" id="bxyjfp_table_list">
    <col id="JGDH" title="机构代号" align="left" type="string" width="100" format="" frozen="" />
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" format="" frozen="" />
    <col id="HYDH" title="行员代号" align="left" type="string" width="80" format="" frozen="" />
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" format="" frozen="" />
    <col id="QSRQ" title="起始日期" align="left" type="string" width="80" format="" frozen="" />
    <col id="JSRQ" title="结束日期" align="left" type="string" width="80" format="" frozen="" />
    <col id="ZLBL" title="增量比例" align="right" type="float" width="80" format="" frozen="" />
    <col id="LSH" title="lsh1" align="right" type="hidden" width="180" format="true" frozen="false" hidden="true" />
    <col id="JYRQ" title="jyrq2" align="right" type="hidden" width="180" format="true" frozen="false" hidden="true" />
  </table>
  <rels>
    <items id="bxyjfp_table_main">
      <item name="hideZd" compareValue="main" operate="isEqual" />
    </items>
    <items id="bxyjfp_table_list">
      <item name="hideZd" compareValue="list" operate="isEqual" />
    </items>
  </rels>
  <performance>
    <primaryKey>LSH</primaryKey>
    <primaryKey>JYRQ</primaryKey>
  </performance>
  <sqlMap>
    <select id="dn12.bxyjfp_select_validateDate" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select count(1) from JXDX_BXJYLS JXDX_BXJYLS where 1=1  and JXDX_BXJYLS.LSH = '$LSH$' and JXDX_BXJYLS.JYRQ = $JYRQ$ and JYRQ &gt; $QSRQ$
    </select>
    <select id="dn12.bxyjfp_select_maxQsrq" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select max(qsrq) from dxgx_yjgx_bx where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$
    </select>
    <select id="dn12.bxyjfp_select_khrq" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select JYRQ from JXDX_BXJYLS where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$
    </select>
    <select id="dn12.bxyjfp_select_minQsrq" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select min(qsrq) from dxgx_yjgx_bx gx where 1=1  and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$
    </select>
    <select id="dn12.bxyjfp_select_mainPage_db2" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select JXDX_BXJYLS.BDH as BDH,JXDX_BXJYLS.JYRQ as JYRQ,JXDX_BXJYLS.LSH as LSH,JXDX_BXJYLS.ZHDH as ZHDH,JXDX_BXJYLS.SXF as SXF,JXDX_BXJYLS.ZHMC as ZHMC,JXDX_BXJYLS.KHH as KHH,khdx_jg.JGMC as JGMC,JXDX_BXJYLS.CJJE as CJJE, case when coalesce(max(dxgx_yjgx_bx.zlbl),0) = 0 then '无关系' when max(dxgx_yjgx_bx.zlbl)=100 then max(khdx_hy.hymc)||'|100' else cast('百分比:'||replace(replace(xml2clob(xmlagg(xmlelement(name a, khdx_hy.hymc||'|'||f_numtochar(dxgx_yjgx_bx.zlbl)||','))),'&lt;A&gt;',''),'&lt;/A&gt;',' ') as varchar(200)) end as DQFPGX from JXDX_BXJYLS JXDX_BXJYLS left outer join dxgx_yjgx_bx dxgx_yjgx_bx on 1=1  and dxgx_yjgx_bx.LSH=JXDX_BXJYLS.LSH and dxgx_yjgx_bx.JYRQ=JXDX_BXJYLS.JYRQ and $sysdate$ between dxgx_yjgx_bx.qsrq and dxgx_yjgx_bx.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_BXJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh where 1=1
      <isNotEmpty property="BDH">and JXDX_BXJYLS.BDH like '%$BDH$%'</isNotEmpty>
      <isNotEmpty property="JSRQ">
        <isEmpty property="QSRQ">and JXDX_BXJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isNotEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty>
      </isNotEmpty>
      group by JXDX_BXJYLS.BDH,JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH,JXDX_BXJYLS.ZHDH,JXDX_BXJYLS.SXF,JXDX_BXJYLS.ZHMC,JXDX_BXJYLS.KHH,khdx_jg.JGMC,JXDX_BXJYLS.CJJE order by JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH
    </select>
    <select id="dn12.bxyjfp_select_mainPage_ora" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select JXDX_BXJYLS.BDH as BDH,JXDX_BXJYLS.JYRQ as JYRQ,JXDX_BXJYLS.LSH as LSH,JXDX_BXJYLS.ZHDH as ZHDH,JXDX_BXJYLS.SXF as SXF,JXDX_BXJYLS.ZHMC as ZHMC,JXDX_BXJYLS.KHH as KHH,khdx_jg.JGMC as JGMC,JXDX_BXJYLS.CJJE as CJJE, F_WM_CONCAT(khdx_hy.hymc || dxgx_yjgx_bx.zlbl) DQFPGX  from JXDX_BXJYLS JXDX_BXJYLS left outer join dxgx_yjgx_bx dxgx_yjgx_bx on 1=1  and dxgx_yjgx_bx.LSH=JXDX_BXJYLS.LSH and dxgx_yjgx_bx.JYRQ=JXDX_BXJYLS.JYRQ and $sysdate$ between dxgx_yjgx_bx.qsrq and dxgx_yjgx_bx.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_BXJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh where 1=1
      <isNotEmpty property="BDH">and JXDX_BXJYLS.BDH like '%$BDH$%'</isNotEmpty>
      <isNotEmpty property="JSRQ">
        <isEmpty property="QSRQ">and JXDX_BXJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isNotEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty>
      </isNotEmpty>
      group by JXDX_BXJYLS.BDH,JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH,JXDX_BXJYLS.ZHDH,JXDX_BXJYLS.SXF,JXDX_BXJYLS.ZHMC,JXDX_BXJYLS.KHH,khdx_jg.JGMC,JXDX_BXJYLS.CJJE order by JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH
    </select>
    <select id="dn12.bxyjfp_select_mainCount_db2" parameterClass="java.util.Map" resultClass="java.lang.Integer" remapResults="true">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select count(1) from (select JXDX_BXJYLS.BDH as BDH,JXDX_BXJYLS.JYRQ as JYRQ,JXDX_BXJYLS.LSH as LSH,JXDX_BXJYLS.ZHDH as ZHDH,JXDX_BXJYLS.SXF as SXF,JXDX_BXJYLS.ZHMC as ZHMC,JXDX_BXJYLS.KHH as KHH,khdx_jg.JGMC as JGMC,JXDX_BXJYLS.CJJE as CJJE, case when coalesce(max(dxgx_yjgx_bx.zlbl),0) = 0 then '无关系' when max(dxgx_yjgx_bx.zlbl)=100 then max(khdx_hy.hymc)||'|100' else cast('百分比:'||replace(replace(xml2clob(xmlagg(xmlelement(name a, khdx_hy.hymc||'|'||f_numtochar(dxgx_yjgx_bx.zlbl)||','))),'&lt;A&gt;',''),'&lt;/A&gt;',' ') as varchar(200)) end as DQFPGX from JXDX_BXJYLS JXDX_BXJYLS left outer join dxgx_yjgx_bx dxgx_yjgx_bx on 1=1  and dxgx_yjgx_bx.LSH=JXDX_BXJYLS.LSH and dxgx_yjgx_bx.JYRQ=JXDX_BXJYLS.JYRQ and $sysdate$ between dxgx_yjgx_bx.qsrq and dxgx_yjgx_bx.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_BXJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh where 1=1
      <isNotEmpty property="BDH">and JXDX_BXJYLS.BDH like '%$BDH$%'</isNotEmpty>
      <isNotEmpty property="JSRQ">
        <isEmpty property="QSRQ">and JXDX_BXJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isNotEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty>
      </isNotEmpty>
      group by JXDX_BXJYLS.BDH,JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH,JXDX_BXJYLS.ZHDH,JXDX_BXJYLS.SXF,JXDX_BXJYLS.ZHMC,JXDX_BXJYLS.KHH,khdx_jg.JGMC,JXDX_BXJYLS.CJJE order by JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH) count
    </select>
    <select id="dn12.bxyjfp_select_mainCount_ora" parameterClass="java.util.Map" resultClass="java.lang.Integer" remapResults="true">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select count(1) from (select JXDX_BXJYLS.BDH as BDH,JXDX_BXJYLS.JYRQ as JYRQ,JXDX_BXJYLS.LSH as LSH,JXDX_BXJYLS.ZHDH as ZHDH,JXDX_BXJYLS.SXF as SXF,JXDX_BXJYLS.ZHMC as ZHMC,JXDX_BXJYLS.KHH as KHH,khdx_jg.JGMC as JGMC,JXDX_BXJYLS.CJJE as CJJE, F_WM_CONCAT(khdx_hy.hymc || dxgx_yjgx_bx.zlbl) DQFPGX  from JXDX_BXJYLS JXDX_BXJYLS left outer join dxgx_yjgx_bx dxgx_yjgx_bx on 1=1  and dxgx_yjgx_bx.LSH=JXDX_BXJYLS.LSH and dxgx_yjgx_bx.JYRQ=JXDX_BXJYLS.JYRQ and $sysdate$ between dxgx_yjgx_bx.qsrq and dxgx_yjgx_bx.jsrq left outer join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jg khdx_jg on khdx_jg.jgdh=JXDX_BXJYLS.jgdh inner join table(FN_GETSJJG_JAVA_QX($sysdate$,$login_khdxdh$,$JGKHDXDH$)) qx on qx.khdxdh=khdx_jg.khdxdh where 1=1
      <isNotEmpty property="BDH">and JXDX_BXJYLS.BDH like '%$BDH$%'</isNotEmpty>
      <isNotEmpty property="JSRQ">
        <isEmpty property="QSRQ">and JXDX_BXJYLS.JYRQ between 20081231 and $JSRQ$</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and 29991231</isEmpty>
      </isNotEmpty>
      <isNotEmpty property="QSRQ">
        <isNotEmpty property="JSRQ">and JXDX_BXJYLS.JYRQ between $QSRQ$ and $JSRQ$</isNotEmpty>
      </isNotEmpty>
      group by JXDX_BXJYLS.BDH,JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH,JXDX_BXJYLS.ZHDH,JXDX_BXJYLS.SXF,JXDX_BXJYLS.ZHMC,JXDX_BXJYLS.KHH,khdx_jg.JGMC,JXDX_BXJYLS.CJJE order by JXDX_BXJYLS.JYRQ,JXDX_BXJYLS.LSH) count
    </select>
    <select id="dn12.bxyjfp_select_gxmxPage" parameterClass="java.util.Map" resultClass="java.util.HashMap">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select distinct khdx_jg.JGDH as JGDH,khdx_hy.HYMC as HYMC,JXDX_BXJYLS.LSH,khdx_hy.HYDH as HYDH,DXGX_YJGX_BX.QSRQ as QSRQ,JXDX_BXJYLS.JYRQ,DXGX_YJGX_BX.JSRQ as JSRQ,khdx_jg.JGMC as JGMC,DXGX_YJGX_BX.ZLBL as ZLBL from dxgx_yjgx_bx dxgx_yjgx_bx inner join JXDX_BXJYLS JXDX_BXJYLS on 1=1  and JXDX_BXJYLS.LSH=dxgx_yjgx_bx.LSH and JXDX_BXJYLS.JYRQ=dxgx_yjgx_bx.JYRQ inner join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jgcy khdx_jgcy on khdx_hy.khdxdh=khdx_jgcy.khdxdh inner join khdx_jg khdx_jg on khdx_jgcy.jgkhdxdh=khdx_jg.khdxdh and $sysdate$ between khdx_jgcy.qsrq and khdx_jgcy.jsrq where 1=1  and dxgx_yjgx_bx.LSH = '$LSH$' and dxgx_yjgx_bx.JYRQ = $JYRQ$ order by dxgx_yjgx_bx.qsrq
    </select>
    <select id="dn12.bxyjfp_select_gxmxCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select count(1) from (select distinct khdx_jg.JGDH as JGDH,khdx_hy.HYMC as HYMC,JXDX_BXJYLS.LSH,khdx_hy.HYDH as HYDH,DXGX_YJGX_BX.QSRQ as QSRQ,JXDX_BXJYLS.JYRQ,DXGX_YJGX_BX.JSRQ as JSRQ,khdx_jg.JGMC as JGMC,DXGX_YJGX_BX.ZLBL as ZLBL from dxgx_yjgx_bx dxgx_yjgx_bx inner join JXDX_BXJYLS JXDX_BXJYLS on 1=1  and JXDX_BXJYLS.LSH=dxgx_yjgx_bx.LSH and JXDX_BXJYLS.JYRQ=dxgx_yjgx_bx.JYRQ inner join khdx_hy khdx_hy on dxgx_yjgx_bx.khdxdh=khdx_hy.khdxdh inner join khdx_jgcy khdx_jgcy on khdx_hy.khdxdh=khdx_jgcy.khdxdh inner join khdx_jg khdx_jg on khdx_jgcy.jgkhdxdh=khdx_jg.khdxdh and $sysdate$ between khdx_jgcy.qsrq and khdx_jgcy.jsrq where 1=1  and dxgx_yjgx_bx.LSH = '$LSH$' and dxgx_yjgx_bx.JYRQ = $JYRQ$ order by dxgx_yjgx_bx.qsrq) a
    </select>
    <delete id="dn12.bxyjfp_delete_last_yjgx" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      delete from dxgx_yjgx_bx where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=29991231
    </delete>
    <update id="dn12.bxyjfp_before_insert_yjgx2" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      update dxgx_yjgx_bx set jsrq=$BEFORE$  where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$ and qsrq=(select max(qsrq) from dxgx_yjgx_bx where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$)
    </update>
    <insert id="dn12.bxyjfp_before_insert_yjgx" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      update dxgx_yjgx_bx set jsrq=$BEFORE$  where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=29991231
    </insert>
    <insert id="dn12.bxyjfp_insert_yjgx" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      insert into DXGX_YJGX_BX(JYRQ,LSH,KHDXDH,QSRQ,JSRQ,ZLBL) values($JYRQ$,'$LSH$',$KHDXDH$,$QSRQ$,$JSRQ$,$ZLBL$)
    </insert>
    <delete id="dn12.bxyjfp_delete_yjgx" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      delete from dxgx_yjgx_bx gx where 1=1  and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$ and gx.jsrq=29991231
    </delete>
    <update id="dn12.bxyjfp_after_delete_yjgx" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      update dxgx_yjgx_bx set jsrq=29991231  where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$ and jsrq=(select max(jsrq) from dxgx_yjgx_bx where 1=1  and LSH = '$LSH$' and JYRQ = $JYRQ$)
    </update>
    <select id="dn12.bxyjfp_select_maxjldh" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select  coalesce(max(jldh),0) from XTB_HYGXRZ_BX
    </select>
    <insert id="dn12.bxyjfp_insert_gxrz" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      insert into XTB_HYGXRZ_BX(JLDH,JLSJ,CZLX,XGRDH,JYRQ,LSH) values($JLDH$,F_GET_SYSTIME(),'$CZLX$',$XGRDH$,$JYRQ$,'$LSH$')
    </insert>
    <insert id="dn12.bxyjfp_insert_gxjl" parameterClass="java.util.Map">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      insert into XTB_HYGXJL_BX(JLDH,GGBZ,KHDXDH,QSRQ,JSRQ,ZLBL) select $JLDH$,'$GGBZ$',gx.KHDXDH,gx.QSRQ,gx.JSRQ,gx.ZLBL from dxgx_yjgx_bx gx where 1=1  and gx.LSH = '$LSH$' and gx.JYRQ = $JYRQ$ and jsrq=29991231
    </insert>
  </sqlMap>
</pageSetting>

