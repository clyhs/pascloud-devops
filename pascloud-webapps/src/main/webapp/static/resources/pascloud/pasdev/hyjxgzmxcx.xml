<?xml version="1.0" encoding="UTF-8"?>

<pageSetting id="hyjxgzmxcx" title="行员绩效工资汇总查询" type="query" version="2.0.0"> 
  <conPart> 
    <tags> 
      <tag row="0" col="0" colspan="1" rowspan="1" name="Date" label="统计年月"> 
        <attribute key="dateFmt" value="yyyyMM"/>  
        <attribute key="defValType" value="xtrzympd"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="name" value="tjrq"/>  
        <attribute key="minDate" value="no"/> 
      </tag>  
      <tag row="0" col="1" colspan="1" rowspan="1" name="NewMultipleHy" label="行员"> 
        <attribute key="isDisplayXN" value="true"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="isRequired" value="false"/>  
        <attribute key="jgckbz" value="jg_ckhy"/>  
        <attribute key="name" value="khdxdh"/>  
        <attribute key="multiple" value="true"/> 
      </tag>  
      <tag row="0" col="2" colspan="1" rowspan="1" name="MSQL4Select" label="行员类别"> 
        <attribute key="selectedList" value="1"/>  
        <attribute key="isMultiple" value="false"/>  
        <attribute key="width" value="120px;"/>  
        <attribute key="mulShowType" value="null"/>  
        <attribute key="key_SELECTTYPE" value="Integer"/>  
        <attribute key="isSearch" value="false"/>  
        <attribute key="sql" value="select lbdh as key, lbmc as value  from csb_hylb"/>  
        <attribute key="isRequired" value="false"/>  
        <attribute key="name" value="lbdh"/>  
        <attribute key="isAll" value="true"/>  
        <attribute key="isEditable" value="true"/> 
      </tag>  
      <tag row="0" col="3" colspan="1" rowspan="1" name="Hidden" label=""> 
        <attribute key="name" value="tjrq_ym"/> 
      </tag> 
    </tags> 
  </conPart>  
  <table id="hyjxgzmxcx_xsjy1jgj" title="新数据源1结果集" page="true"> 
    <col id="TJRQ" title="统计年月" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="JGMC" title="机构名称" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HYDH" title="行员代号" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="GWMC" title="行员岗位" align="left" type="string" width="80" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="SQQE" title="上期欠额" align="right" type="float" width="80" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="YFJXGZ" title="应发绩效工资" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="SFJXGZ" title="实发绩效工资" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="JGKHJX" title="机构考核绩效" align="right" type="float" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="jgkhjx"/>  
    <col id="LZJX" title="履职绩效" align="right" type="float" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="lzJx"/>  
    <col id="CKJXGZ" title="存款绩效工资" align="right" type="float" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="ckMx"/>  
    <col id="DKJXGZ" title="贷款绩效工资" align="right" type="float" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="dkMx"/>  
    <col id="YWLJXGZ" title="业务量绩效工资" align="right" type="float" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="yjMx"/>  
    <col id="DKTJJX" title="贷款推荐绩效" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="tjMx"/>  
    <col id="ECKHJX" title="二次考核绩效" align="left" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="ecMx"/>  
    <col id="GLJX" title="管理绩效" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="gljxcx"/>  
    <col id="JGYJJX" title="机构业绩绩效" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="ZJYWJXGZ" title="中间业务绩效工资" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="DZYHJXGZ" title="电子银行绩效工资" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="BLDKQSJL" title="不良贷款清收奖励" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="GGYJJXFP" title="公共业绩绩效分配" align="right" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="ZHKMJX" title="增户扩面绩效" align="left" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/>  
    <col id="ZXGJYWJJGZ" title="专项国际业务计价工资" align="left" type="float" width="130" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/>  
    <col id="FXJKH" title="风险金考核" align="left" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/>  
    <col id="FFZLJX" title="服务质量绩效" align="left" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/>  
    <col id="QTJCJX" title="其他奖惩绩效" align="left" type="float" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/>  
    <col id="KHDXDH" title="考核对象代号" align="left" type="hidden" width="110" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HYLB" title="行员类别" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="JGLB" title="机构类别" align="left" type="string" width="90" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="LBDH" title="类别编号" align="left" type="hidden" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="" mergeCells="false" footerCells="false"/> 
  </table>  
  <sqlMap namespace="studio.hyjxgzmxcx"> 
    <select id="dn0.hyjxgzmxcxList" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select $tjrq$ as tjrq,jglb.lbmc as jglb,jg.jgmc,hy.hydh,hy.hymc,hylb.lbdh,hylb.lbmc as hylb,coalesce(hygw.gwmc,'') as gwmc,jxgz.sqqe,jxgz.yfjxgz, jxgz.sfjxgz, jxgz.jgkhjx, jxgz.jgyjjx, jxgz.gljx, jxgz.lzjx, jxgz.ckjxgz, jxgz.dkjxgz, jxgz.zjywjxgz, jxgz.dzyhjxgz, jxgz.ywljxgz, jxgz.bldkqsjl, jxgz.dktjjx, jxgz.yjkzxm1 as zhkmjx, jxgz.yjkzxm2 as zxgjywjjgz, jxgz.yjkzxm3 as fxjkh, jxgz.yjkzxm4 as ffzljx, jxgz.ggyjjxfp, jxgz.jxkzxm1 as qtjcjx, jxgz.jxkzxm2 as eckhjx, jxgz.khdxdh from JXGZ_JXGZHZ jxgz inner join khdx_hy hy on hy.khdxdh=jxgz.khdxdh inner join khdx_hylb hylb on hylb.khdxdh=hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between hylb.qsrq and hylb.jsrq</isNotEmpty> left join KHDX_HYGW hygw on hy.khdxdh=hygw.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between hygw.qsrq and hygw.jsrq</isNotEmpty> inner join khdx_jgcy cy on cy.khdxdh=hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between cy.qsrq and cy.jsrq</isNotEmpty> inner join khdx_jg jg on cy.jgkhdxdh=jg.khdxdh inner join KHDX_JGLB jglb on jglb.khdxdh=jg.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between jglb.qsrq and jglb.jsrq</isNotEmpty> inner join table(FN_GETSJJG_JAVA_QXHY($tjrq_ym$,$login_khdxdh$,0)) qxhy on hy.khdxdh=qxhy.khdxdh where 1=1 
      <isNotEmpty property="khdxdh">and hy.khdxdh in ($khdxdh$)</isNotEmpty>  
      <isNotEmpty property="tjrq_ym">and jxgz.tjrq=$tjrq_ym$</isNotEmpty>  
      <isNotEmpty property="lbdh">and hylb.lbdh='$lbdh$'</isNotEmpty> order by jg.jgdh,hy.hydh
    </select>  
    <select id="dn0.hyjxgzmxcxCount" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from ( select $tjrq$ as tjrq,jglb.lbmc as jglb,jg.jgmc,hy.hydh,hy.hymc,hylb.lbdh,hylb.lbmc as hylb,coalesce(hygw.gwmc,'') as gwmc,jxgz.sqqe,jxgz.yfjxgz, jxgz.sfjxgz, jxgz.jgkhjx, jxgz.jgyjjx, jxgz.gljx, jxgz.lzjx, jxgz.ckjxgz, jxgz.dkjxgz, jxgz.zjywjxgz, jxgz.dzyhjxgz, jxgz.ywljxgz, jxgz.bldkqsjl, jxgz.dktjjx, jxgz.yjkzxm1 as zhkmjx, jxgz.yjkzxm2 as zxgjywjjgz, jxgz.yjkzxm3 as fxjkh, jxgz.yjkzxm4 as ffzljx, jxgz.ggyjjxfp, jxgz.jxkzxm1 as qtjcjx, jxgz.jxkzxm2 as eckhjx, jxgz.khdxdh from JXGZ_JXGZHZ jxgz inner join khdx_hy hy on hy.khdxdh=jxgz.khdxdh inner join khdx_hylb hylb on hylb.khdxdh=hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between hylb.qsrq and hylb.jsrq</isNotEmpty> left join KHDX_HYGW hygw on hy.khdxdh=hygw.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between hygw.qsrq and hygw.jsrq</isNotEmpty> inner join khdx_jgcy cy on cy.khdxdh=hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between cy.qsrq and cy.jsrq</isNotEmpty> inner join khdx_jg jg on cy.jgkhdxdh=jg.khdxdh inner join KHDX_JGLB jglb on jglb.khdxdh=jg.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between jglb.qsrq and jglb.jsrq</isNotEmpty> inner join table(FN_GETSJJG_JAVA_QXHY($tjrq_ym$,$login_khdxdh$,0)) qxhy on hy.khdxdh=qxhy.khdxdh where 1=1 
      <isNotEmpty property="khdxdh">and hy.khdxdh in ($khdxdh$)</isNotEmpty>  
      <isNotEmpty property="tjrq_ym">and jxgz.tjrq=$tjrq_ym$</isNotEmpty>  
      <isNotEmpty property="lbdh">and hylb.lbdh='$lbdh$'</isNotEmpty> order by jg.jgdh,hy.hydh ) t
    </select>  
    <select id="dn0.hyjxgzmxcx_MSQL4SELECT_lbdh" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">/**!mycat:datanode=$db$**/ select lbdh as key, lbmc as value from csb_hylb</select> 
  </sqlMap>  
  <rels> 
    <items id="hyjxgzmxcx_xsjy1jgj"/> 
  </rels>  
  <javascript><![CDATA[jQuery(document).ready(function () {
   var obj=createTimeObj(jQuery("#sysDate").val());
    if(jQuery("#sysDate").val()!=obj.ym){
        var sym=obj.sym;
        jQuery("#tjrq").val(sym.substr(0,6));
    }
});

//自定义验证，在提交时执行。通过返回true，否则返回false
function customValidate(){
var o_tjrq = createTimeObj($("#tjrq").val());
 $("#tjrq_ym").val(o_tjrq.ym);
 return true;
}
function jgJx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  var hylb = obj['HYLB'];
  if (hylb ="支行人员"){
    querySubQuery(paramsJasonString,"jgkhjxcx",'80','40','tag');  
  } else {
    querySubQuery(paramsJasonString,"bskhjxcx",'80','40','tag');
  }  
}
function lzJx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"lzjxcx",'80','40','tag');
}
function glJx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"gljxcx",'80','40','tag');
}
function ckMx(obj){
 var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
 querySubQuery(paramsJasonString,"hyckjxgzcx",'80','40','tag');
}
function dkMx(obj){
 var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"hydkjxgz",'80','40','tag');
}
function tjMx(obj){
 var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"dktjjx",'80','40','tag');
}
function ywMx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"hyywljxgzcx",'80','40','tag');
}
function ecMx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"eckhjxcx",'80','40','tag');
}
function yjMx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"','lbdh':'"+obj['LBDH']+"'}";
  querySubQuery(paramsJasonString,"hyywljxgzcx",'80','40','tag');
}
function gljxcx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"gljxcx",'80','40','tag');
}

function jgkhjx(obj){
  var lbdh = obj['LBDH'];
  var hyRow = new Array('A01','A02','A03');
  var flag = false;
  for(var i in hyRow) {
    if(lbdh.indexOf(hyRow[i])>-1) {
        flag = true;
    }
  }
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"','lbdh':'"+obj['LBDH']+"'}";
  if(flag) {//为支行人员跳转到机构考核绩效
    querySubQuery(paramsJasonString,"bskhjxcx",'80','40','tag');
  }else {
    querySubQuery(paramsJasonString,"jgkhjxcx",'80','40','tag');
  }

  
}

/*

function xjKf(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"ggckxjkfxc",'80','40','tag');
}

function bmJx(obj){
  var paramsJasonString = "{"+"'tjrq':'"+obj['TJRQ']+"','khdxdh':'"+obj['KHDXDH']+"'}";
  querySubQuery(paramsJasonString,"jgkhjxfpgl",'80','40','tag');
}*/]]></javascript> 
</pageSetting>
