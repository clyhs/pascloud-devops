<?xml version="1.0" encoding="UTF-8"?>

<pageSetting id="hyxxgl" title="行员信息管理" type="manage"> 
  <conPart> 
    <tags> 
      <tag row="0" col="0" rowspan="1" colspan="1" name="MSQL4Select" label="行员类别" fieldName=""> 
        <attribute key="sql" value="select lbdh as key, lbmc as value from csb_hylb"/>  
        <attribute key="isSearch" value="false"/>  
        <attribute key="isRequired" value="false"/>  
        <attribute key="isMultiple" value="false"/>  
        <attribute key="name" value="hylb"/>  
        <attribute key="width" value="120px;"/>  
        <attribute key="isAll" value="true"/>  
        <attribute key="isEditable" value="true"/> 
      </tag>  
      <tag row="0" col="1" rowspan="1" colspan="1" name="Text" label="行员" fieldName=""> 
        <attribute key="name" value="hydh"/>  
        <attribute key="readonly" value="false"/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag row="0" col="2" rowspan="1" colspan="1" name="Hidden" label="" fieldName=""> 
        <attribute key="name" value="cxtj"/> 
      </tag> 
    </tags> 
  </conPart>  
  <table page="true" id="hyxxgltable"> 
    <col id="JGDH" title="机构代号" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="LBDH" title="类别代号" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="LBMC" title="类别名称" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="HYDH" title="行员代号" align="left" type="string" width="75" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="SJHM" title="手机号码" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="YJDZ" title="邮件地址" align="left" type="string" width="180" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="WXH" title="微信号" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy="" showDymCol="true"/>  
    <col id="KHDXDH" title="考核对象代号" align="left" type="hidden" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="" zsy=""/> 
  </table>  
  <rels> 
    <items id="hyxxgltable"/> 
  </rels>  
  <addPage title="编辑页面"> 
    <tag row="0" col="0" rowspan="1" colspan="1" name="NewMultipleHy" label="行员" fieldName=""> 
      <attribute key="isRequired" value="true"/>  
      <attribute key="isDisplayXN" value="true"/>  
      <attribute key="jgckbz" value="jg_ckhy"/>  
      <attribute key="name" value="khdxdh"/>  
      <attribute key="multiple" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="1" col="0" rowspan="1" colspan="1" name="Text" label="手机号码" fieldName="SJHM"> 
      <attribute key="name" value="sjhm"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="2" col="0" rowspan="1" colspan="1" name="Text" label="邮件地址" fieldName="YJDZ"> 
      <attribute key="name" value="yjdz"/>  
      <attribute key="styleClass" value="required"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="3" col="0" rowspan="1" colspan="1" name="Text" label="微信号" fieldName="WXH"> 
      <attribute key="name" value="wxh"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="4" col="0" rowspan="1" colspan="1" name="Hidden" label="" fieldName="HYDH"> 
      <attribute key="name" value="hydh"/> 
    </tag> 
  </addPage>  
  <updatePage title="编辑页面"> 
    <tag row="0" col="0" rowspan="1" colspan="1" name="NewMultipleHy" label="行员" fieldName=""> 
      <attribute key="isRequired" value="true"/>  
      <attribute key="isDisplayXN" value="true"/>  
      <attribute key="jgckbz" value="jg_ckhy"/>  
      <attribute key="name" value="khdxdh"/>  
      <attribute key="multiple" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="1" col="0" rowspan="1" colspan="1" name="Text" label="手机号码" fieldName="SJHM"> 
      <attribute key="name" value="sjhm"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="2" col="0" rowspan="1" colspan="1" name="Text" label="邮件地址" fieldName="YJDZ"> 
      <attribute key="name" value="yjdz"/>  
      <attribute key="styleClass" value="required"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="3" col="0" rowspan="1" colspan="1" name="Text" label="微信号" fieldName="WXH"> 
      <attribute key="name" value="wxh"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="4" col="0" rowspan="1" colspan="1" name="Hidden" label="" fieldName="HYDH"> 
      <attribute key="name" value="hydh"/> 
    </tag> 
  </updatePage>  
  <buttons> 
    <button>add</button>  
    <button>edit</button>  
    <button>delete</button>  
    <button>import</button> 
  </buttons>  
  <flow> 
    <insertbefore/>  
    <insertafter/>  
    <deletebefore/>  
    <deleteafter/>  
    <updatebefore/>  
    <updateafter/> 
  </flow>  
  <sqlMap namespace="studio.hyxxgl"> 
    <select id="dn0.hyxxglList" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select hyxx.hydh ,hy.khdxdh, hy.hymc ,hylb.lbdh,hylb.lbmc,jg.jgdh,jg.jgmc, hyxx.wxh , hyxx.sjhm, hyxx.yjdz from mpas_hyxx hyxx inner join khdx_hy hy on hyxx.hydh = hy.hydh inner join khdx_hylb hylb on hy.khdxdh = hylb.khdxdh inner join khdx_jgcy jgcy on hy.khdxdh = jgcy.khdxdh inner join khdx_jg jg on jg.khdxdh = jgcy.jgkhdxdh inner join csb_hylb a on a.lbdh = hylb.lbdh where 1=1 
      <isNotEmpty property="hylb">and a.lbdh = '$hylb$'</isNotEmpty> and 1=1 and(hy.hymc like '%$hydh$%'or hy.hydh like '%$hydh$%')
    </select>  
    <select id="dn0.hyxxglCount" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from ( select hyxx.hydh ,hy.khdxdh, hy.hymc ,hylb.lbdh,hylb.lbmc,jg.jgdh,jg.jgmc, hyxx.wxh , hyxx.sjhm, hyxx.yjdz from mpas_hyxx hyxx inner join khdx_hy hy on hyxx.hydh = hy.hydh inner join khdx_hylb hylb on hy.khdxdh = hylb.khdxdh inner join khdx_jgcy jgcy on hy.khdxdh = jgcy.khdxdh inner join khdx_jg jg on jg.khdxdh = jgcy.jgkhdxdh inner join csb_hylb a on a.lbdh = hylb.lbdh where 1=1 
      <isNotEmpty property="hylb">and a.lbdh = '$hylb$'</isNotEmpty> and 1=1 and(hy.hymc like '%$hydh$%'or hy.hydh like '%$hydh$%') ) t
    </select>  
    <select id="dn0.hyxxgl_select_by_primaryKey" parameterClass="java.util.Map" resultClass="java.util.HashMap"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select YJDZ, HYDH, WXH, SJHM from MPAS_HYXX where 1= 1 and HYDH = '$hydh$'
    </select>  
    <select id="dn0.hyxxgl_check_insert" parameterClass="java.util.Map" resultClass="java.util.HashMap"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select YJDZ, HYDH, WXH, SJHM from MPAS_HYXX where 1= 1 and HYDH = '$hydh$'
    </select>  
    <insert id="dn0.hyxxgl_insert" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> insert into MPAS_HYXX( YJDZ, HYDH, SJHM, WXH ) values ( '$yjdz$','$hydh$','$sjhm$','$wxh$')
    </insert>  
    <update id="dn0.hyxxgl_update" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> update MPAS_HYXX set YJDZ = '$yjdz$',SJHM = '$sjhm$',WXH = '$wxh$' where 1=1 and HYDH = '$hydh$'
    </update>  
    <delete id="dn0.hyxxgl_delete" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> delete from MPAS_HYXX where 1=1 and HYDH = '$hydh$'
    </delete>  
    <select id="dn0.hyxxgl_MSQL4SELECT_hylb" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">/**!mycat:datanode=$db$**/ select lbdh as key, lbmc as value from csb_hylb</select> 
  </sqlMap>  
  <javascript> 
    <import>parent.addTab('hyxxgldr','行员信息管理','../studio/impParser.do?method=visitHTML&amp;funId=hyxxgldr');</import>  
    <query>jQuery(document).ready(function () { }); //自定义验证，在提交时执行。通过返回true，否则返回false function customValidate(){ if(jQuery('#hydh').val()!=''){ jQuery('#cxtj').val('and (hyxx.hydh like ''%$hydh$%'' or hy.hymc like ''%$hydh$%'' )'); }else{ jQuery('#cxtj').val(''); } return true; }</query>  
    <edit>jQuery(document).ready(function () { //这里的js脚本，会在页面加载完成后执行 if($("#page_operate").val()=="update"){ $("#khdxdh_mc").attr("disabled","disabled"); }else{ $("#khdxdh_mc").removeAttr("disabled"); } }); //自定义验证，在提交时执行。通过返回true，否则返回false function customValidate(){ $("#hydh").val($("#khdxdh_dh").val()); return check_phone()&amp;&amp;check_email(); } function check_phone(){ var phone=jQuery("#sjhm").val(); if(trim(phone)==0){ return true; }else{ if(!(/(^[1][358][0-9]{9}$)/.test(phone))){ alert("电话格式不正确!"); return false; }else{ return true; } } } function check_email(){ var email=jQuery("#yjdz").val(); //获得邮件并去掉空格 var msg1="email_div"; var re =/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,5}$/; if(email==""){ alert("系统未检测到您的输入!"); return false; }else if(!email.match(re)){ alert("安全email非常重要请注意格式!"); return false; }else{ return true; } } 　　 function trim(str){ //删除左右两端的空格 　　 return str.replace(/(^\\s*)|(\\s*$)/g, ""); 　　 }</edit> 
  </javascript> 
</pageSetting>
