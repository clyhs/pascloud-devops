<?xml version="1.0" encoding="UTF-8"?>

<pageSetting id="dkqxkfmxcx" title="贷款欠息扣罚明细查询" type="query" version="2.0.0"> 
  <conPart> 
    <tags> 
      <tag row="0" col="0" colspan="1" rowspan="1" name="Date" label="统计年月"> 
        <attribute key="dateFmt" value="yyyyMM"/>  
        <attribute key="defValType" value="sysDate"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="name" value="tjrq"/>  
        <attribute key="minDate" value="no"/> 
      </tag>  
      <tag row="0" col="0" colspan="1" rowspan="1" name="Hidden" label=""> 
        <attribute key="name" value="tjrq_ym"/> 
      </tag>  
      <tag row="0" col="1" colspan="1" rowspan="1" name="NewMultipleHy" label="行员"> 
        <attribute key="isDisplayXN" value="true"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="style" value="width:100px;"/>  
        <attribute key="isRequired" value="false"/>  
        <attribute key="jgckbz" value="jg_ckhy"/>  
        <attribute key="name" value="khdxdh"/>  
        <attribute key="multiple" value="true"/> 
      </tag>  
      <tag row="0" col="2" colspan="1" rowspan="1" name="Dmms" label="客户类型"> 
        <attribute key="width" value="120px;"/>  
        <attribute key="dmmc" value="zhbs"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="zhbs"/>  
        <attribute key="isAll" value="true"/>  
        <attribute key="multiple" value="false"/> 
      </tag>  
      <tag row="0" col="3" colspan="1" rowspan="1" name="Text" label="客户号"> 
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="khh"/>  
        <attribute key="readonly" value="false"/> 
      </tag>  
      <tag row="1" col="0" colspan="1" rowspan="1" name="Text" label="客户名称"> 
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="zhhm"/>  
        <attribute key="readonly" value="false"/> 
      </tag>  
      <tag row="1" col="1" colspan="1" rowspan="1" name="Text" label="贷款账号"> 
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="zhdh"/>  
        <attribute key="readonly" value="false"/> 
      </tag>  
      <tag row="1" col="2" colspan="1" rowspan="1" name="Number" label="客户金额区间"> 
        <attribute key="precision" value="4"/>  
        <attribute key="intparts" value="10"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="khjeqjxx"/>  
        <attribute key="readonly" value="false"/> 
      </tag>  
      <tag row="1" col="3" colspan="1" rowspan="1" name="Number" label="至"> 
        <attribute key="precision" value="4"/>  
        <attribute key="intparts" value="10"/>  
        <attribute key="editable" value="true"/>  
        <attribute key="name" value="khjeqjsx"/>  
        <attribute key="readonly" value="false"/> 
      </tag> 
    </tags> 
  </conPart>  
  <table id="dkqxkfmxcx_xsjy1jgj" title="新数据源1结果集" page="true"> 
    <col id="TJRQ" title="统计年月" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="true" mergeCells="false" footerCells="false"/>  
    <col id="JGDH" title="机构代号" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HYDH" title="行员代号" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="KHH" title="客户号" align="left" type="string" width="150" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="ZHHM" title="客户名称" align="left" type="string" width="150" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="KHLX" title="客户类型" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="ZHDH" title="贷款账号" align="left" type="string" width="150" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="PJH" title="票据号" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="HTH" title="合同号" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="KMH" title="科目号" align="left" type="string" width="80" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="BZZWMC" title="币种" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="QX" title="贷款期限" align="left" type="string" width="100" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="FFRQ" title="发放日期" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="DQRQ" title="到期日期" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="DKJE" title="贷款金额" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="KHDKJE" title="客户贷款金额" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="KFBZ" title="扣罚标准（元/万元）" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false"/>  
    <col id="YSWSLXXZ" title="当月未回收利息" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="true" mergeCells="false" footerCells="true"/>  
    <col id="KFJE" title="扣罚金额" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="true" mergeCells="false" footerCells="true"/> 
  </table>  
  <sqlMap namespace="studio.dkqxkfmxcx"> 
    <select id="dn0.dkqxkfmxcxList" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select substr(cast(kfmx.tjrq as char(8)), 1, 6) as tjrq, jg.jgdh, jg.jgmc, hy.hydh, hy.hymc, dkzh.khh, dkzh.zhhm, dmms.dmms as khlx, dkzh.zhdh, dkzh.pjh, dkzh.hth, dkzh.kmh, bz.bzzwmc, qxsdb.qxmc as qx, dkzh.ffrq, dkzh.dqrq, dkzh.dkje, kfmx.khdkje, kfmx.kfbz, kfmx.yswslxxz, kfmx.kfje from dkjx_dkqxkfmx kfmx inner join khdx_hy hy on kfmx.khdxdh = hy.khdxdh inner join khdx_jgcy jgcy on jgcy.khdxdh = hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between jgcy.qsrq and jgcy.jsrq</isNotEmpty> inner join khdx_jg jg on jg.khdxdh = jgcy.jgkhdxdh inner join table(fn_getsjjg_java_qxhy($tjrq_ym$, $login_khdxdh$, 0)) qxhy on hy.khdxdh=qxhy.khdxdh inner join csb_dmms dmms on dmms.dmz = kfmx.zhbs and dmmc='ZHBS' inner join jxdx_dkzh dkzh on dkzh.jxdxdh = kfmx.jxdxdh inner join csb_qxsdb qxsdb ON dkzh.QX BETWEEN qxsdb.QSQX AND qxsdb.JSQX and qxsdb.jxdxlx=2 inner join csb_bz bz on bz.bz = dkzh.bz where 1=1
      <isNotEmpty property="khdxdh">and hy.khdxdh in ($khdxdh$)</isNotEmpty>  
      <isNotEmpty property="zhbs">and kfmx.zhbs='$zhbs$'</isNotEmpty>  
      <isNotEmpty property="khh">and kfmx.khh like '%$khh$%'</isNotEmpty>  
      <isNotEmpty property="zhhm">and dkzh.zhhm like '%$zhhm$%'</isNotEmpty>  
      <isNotEmpty property="zhdh">and dkzh.zhdh like '%$zhdh$%'</isNotEmpty>  
      <isNotEmpty property="tjrq">and kfmx.tjrq between $tjrq$01 and $tjrq_ym$</isNotEmpty>  
      <isNotEmpty property="khjeqjxx">and kfmx.khdkje between $khjeqjxx$ and $khjeqjsx$</isNotEmpty> 
    </select>  
    <select id="dn0.dkqxkfmxcxCount" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from ( select substr(cast(kfmx.tjrq as char(8)), 1, 6) as tjrq, jg.jgdh, jg.jgmc, hy.hydh, hy.hymc, dkzh.khh, dkzh.zhhm, dmms.dmms as khlx, dkzh.zhdh, dkzh.pjh, dkzh.hth, dkzh.kmh, bz.bzzwmc, qxsdb.qxmc as qx, dkzh.ffrq, dkzh.dqrq, dkzh.dkje, kfmx.khdkje, kfmx.kfbz, kfmx.yswslxxz, kfmx.kfje from dkjx_dkqxkfmx kfmx inner join khdx_hy hy on kfmx.khdxdh = hy.khdxdh inner join khdx_jgcy jgcy on jgcy.khdxdh = hy.khdxdh 
      <isNotEmpty property="tjrq_ym">and $tjrq_ym$ between jgcy.qsrq and jgcy.jsrq</isNotEmpty> inner join khdx_jg jg on jg.khdxdh = jgcy.jgkhdxdh inner join table(fn_getsjjg_java_qxhy($tjrq_ym$, $login_khdxdh$, 0)) qxhy on hy.khdxdh=qxhy.khdxdh inner join csb_dmms dmms on dmms.dmz = kfmx.zhbs and dmmc='ZHBS' inner join jxdx_dkzh dkzh on dkzh.jxdxdh = kfmx.jxdxdh inner join csb_qxsdb qxsdb ON dkzh.QX BETWEEN qxsdb.QSQX AND qxsdb.JSQX and qxsdb.jxdxlx=2 inner join csb_bz bz on bz.bz = dkzh.bz where 1=1 
      <isNotEmpty property="khdxdh">and hy.khdxdh in ($khdxdh$)</isNotEmpty>  
      <isNotEmpty property="zhbs">and kfmx.zhbs='$zhbs$'</isNotEmpty>  
      <isNotEmpty property="khh">and kfmx.khh like '%$khh$%'</isNotEmpty>  
      <isNotEmpty property="zhhm">and dkzh.zhhm like '%$zhhm$%'</isNotEmpty>  
      <isNotEmpty property="zhdh">and dkzh.zhdh like '%$zhdh$%'</isNotEmpty>  
      <isNotEmpty property="tjrq">and kfmx.tjrq between $tjrq$01 and $tjrq_ym$</isNotEmpty>  
      <isNotEmpty property="khjeqjxx">and kfmx.khdkje between $khjeqjxx$ and $khjeqjsx$</isNotEmpty> ) t
    </select> 
  </sqlMap>  
  <rels> 
    <items id="dkqxkfmxcx_xsjy1jgj"/> 
  </rels>  
  <javascript><![CDATA[jQuery(document).ready(function () {
  $("#khjeqjxx").attr("class","{required:false,decimal:[25,2]}");
  $("#khjeqjsx").attr("class","{required:false,decimal:[25,2]}");
  //var obj=createTimeObj(jQuery("#tjrq").val());
  var obj=createTimeObj(jQuery("#sysDate").val());
    if(jQuery("#sysDate").val()!=obj.ym){
        var sym=obj.sym;
        jQuery("#tjrq").val(sym.substr(0,6));
    }
});

//自定义验证，在提交时执行。通过返回true，否则返回false
function customValidate(){
 var khjeqjxx = parseFloat($("#khjeqjxx").val());
 var khjeqjsx = parseFloat($("#khjeqjsx").val());
 if(isNaN(khjeqjxx)&&!isNaN(khjeqjsx)){
   parent.custom_alert("客户金额区间范围错误");
   return false;
 }
 if(!isNaN(khjeqjxx)&&isNaN(khjeqjsx)){
   parent.custom_alert("客户金额区间范围错误");
   return false;
 }
 if(khjeqjxx > khjeqjsx){
   parent.custom_alert("客户金额区间范围错误");
   return false;
 }
 
 var o_tjrq = createTimeObj($("#tjrq").val());
 $("#tjrq_ym").val(o_tjrq.ym);
 return true;
}]]></javascript> 
</pageSetting>
