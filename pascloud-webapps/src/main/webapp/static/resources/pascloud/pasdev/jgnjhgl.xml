<?xml version="1.0" encoding="UTF-8"?>

<pageSetting id="jgnjhgl" title="机构年计划管理" type="manage" version="1.0.0.0" pid="" desc="标准版"> 
  <conPart> 
    <tags> 
      <tag row="0" col="0" rowspan="1" colspan="1" name="Date" label="年份" fieldName=""> 
        <attribute key="isRequired" value="true"/>  
        <attribute key="name" value="khnf"/>  
        <attribute key="minDate" value="no"/>  
        <attribute key="defValType" value="sysDate"/>  
        <attribute key="dateFmt" value="yyyy"/>  
        <attribute key="readonly" value="false"/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag row="0" col="1" rowspan="1" colspan="1" name="NewJg" label="机构" fieldName=""> 
        <attribute key="ckbz" value="jg"/>  
        <attribute key="cascadeCheck" value="true"/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="style" value="width:160px;"/>  
        <attribute key="name" value="jgkhdxdh"/>  
        <attribute key="multiple" value="true"/>  
        <attribute key="editable" value="true"/> 
      </tag>  
      <tag row="0" col="2" rowspan="1" colspan="1" name="JGKhzbSelect" label="考核指标" fieldName=""> 
        <attribute key="isSearch" value="true"/>  
        <attribute key="isRequired" value="true"/>  
        <attribute key="isMultiple" value="false"/>  
        <attribute key="name" value="khzbdh"/>  
        <attribute key="width" value="250px;"/>  
        <attribute key="isAll" value="true"/>  
        <attribute key="multiple" value="false"/>  
        <attribute key="isEditable" value="true"/>  
        <attribute key="editable" value="true"/> 
      </tag> 
    </tags> 
  </conPart>  
  <table page="true" id="jgnjhgltable"> 
    <col id="KHNF" title="年份" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="JGDH" title="机构代号" align="left" type="string" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="KHZBMC" title="考核指标名称" align="left" type="string" width="200" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="JHZ" title="计划值" align="right" type="float" width="120" format="##0.00" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="LZZ" title="力争值" align="right" type="float" width="120" format="##0.00" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="false"/>  
    <col id="KHZBDH" title="KHZBDH" align="center" type="hidden" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true"/>  
    <col id="KHDXDH" title="考核对象代号" align="left" type="hidden" width="120" format="" frozen="false" mergeCells="false" footerCells="false" exp="true" zsy="true" showDymCol="true"/> 
  </table>  
  <rels> 
    <items id="jgnjhgltable"/> 
  </rels>  
  <addPage title="编辑页面"> 
    <tag row="0" col="0" rowspan="1" colspan="1" name="Text" label="年份" fieldName="KHNF"> 
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="jgnjh_nf"/>  
      <attribute key="readonly" value="true"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="1" col="0" rowspan="1" colspan="1" name="NewJg" label="机构" fieldName="KHDXDH"> 
      <attribute key="ckbz" value="jg_ckhy"/>  
      <attribute key="cascadeCheck" value="true"/>  
      <attribute key="isRequired" value="true"/>  
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="jgkhdxdh"/>  
      <attribute key="multiple" value="false"/>  
      <attribute key="editable" value="false"/> 
    </tag>  
    <tag row="2" col="0" rowspan="1" colspan="1" name="Text" label="考核指标" fieldName=""> 
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="khzbmc"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="false"/> 
    </tag>  
    <tag row="2" col="1" rowspan="1" colspan="1" name="Hidden" label="" fieldName="KHZBDH"> 
      <attribute key="name" value="KHZBDH"/> 
    </tag>  
    <tag row="3" col="0" rowspan="1" colspan="1" name="Number" label="计划值" fieldName="JHZ"> 
      <attribute key="precision" value="4"/>  
      <attribute key="style" value="px;text-align:right;"/>  
      <attribute key="name" value="jgnjh_jhz"/>  
      <attribute key="intparts" value="21"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="4" col="0" rowspan="1" colspan="1" name="Number" label="力争值" fieldName="LZZ"> 
      <attribute key="precision" value="4"/>  
      <attribute key="style" value="160px;text-align:right;"/>  
      <attribute key="name" value="jgnjh_lzz"/>  
      <attribute key="intparts" value="21"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag> 
  </addPage>  
  <updatePage title="编辑页面"> 
    <tag row="0" col="0" rowspan="1" colspan="1" name="Text" label="年份" fieldName="KHNF"> 
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="jgnjh_nf"/>  
      <attribute key="isAll" value="false"/>  
      <attribute key="readonly" value="true"/>  
      <attribute key="isEditable" value="false"/>  
      <attribute key="editable" value="false"/> 
    </tag>  
    <tag row="1" col="0" rowspan="1" colspan="1" name="NewJg" label="机构" fieldName="KHDXDH"> 
      <attribute key="ckbz" value="jg_ckhy"/>  
      <attribute key="cascadeCheck" value="true"/>  
      <attribute key="isRequired" value="true"/>  
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="jgkhdxdh"/>  
      <attribute key="isAll" value="false"/>  
      <attribute key="multiple" value="false"/>  
      <attribute key="isEditable" value="false"/>  
      <attribute key="editable" value="false"/> 
    </tag>  
    <tag row="2" col="0" rowspan="1" colspan="1" name="Text" label="考核指标" fieldName=""> 
      <attribute key="style" value="160px;"/>  
      <attribute key="name" value="khzbmc"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="false"/> 
    </tag>  
    <tag row="2" col="1" rowspan="1" colspan="1" name="Hidden" label="" fieldName="KHZBDH"> 
      <attribute key="name" value="KHZBDH"/> 
    </tag>  
    <tag row="3" col="0" rowspan="1" colspan="1" name="Number" label="计划值" fieldName="JHZ"> 
      <attribute key="precision" value="4"/>  
      <attribute key="style" value="px;text-align:right;"/>  
      <attribute key="name" value="jgnjh_jhz"/>  
      <attribute key="intparts" value="21"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag>  
    <tag row="4" col="0" rowspan="1" colspan="1" name="Number" label="力争值" fieldName="LZZ"> 
      <attribute key="precision" value="4"/>  
      <attribute key="style" value="160px;text-align:right;"/>  
      <attribute key="name" value="jgnjh_lzz"/>  
      <attribute key="intparts" value="21"/>  
      <attribute key="readonly" value="false"/>  
      <attribute key="editable" value="true"/> 
    </tag> 
  </updatePage>  
  <buttons> 
    <button>add</button>  
    <button>edit</button>  
    <button>delete</button>  
    <button>import</button> 
  </buttons>  
  <flow> 
    <insertbefore/>  
    <insertafter/>  
    <deletebefore/>  
    <deleteafter/>  
    <updatebefore/>  
    <updateafter/> 
  </flow>  
  <sqlMap namespace="studio.jgnjhgl"> 
    <select id="dn0.jgnjhglList" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select jh.khnf, jh.khdxdh, qx.jgdh, qx.jgmc, khzb.khzbmc, jh.jhz, jh.lzz,khzb.khzbdh from yjzb_jgnjh jh inner join khfa_khzb_jg khzb on jh.khzbdh=khzb.khzbdh inner join table(fn_getsjjg_java_qx($sysdate$, $login_khdxdh$, 0)) qx on qx.khdxdh=jh.khdxdh where 1=1 
      <isNotEmpty property="khnf">and jh.khnf =$khnf$</isNotEmpty>  
      <isNotEmpty property="khzbdh">and khzb.khzbdh=$khzbdh$</isNotEmpty>  
      <isNotEmpty property="jgkhdxdh">and qx.khdxdh in ($jgkhdxdh$)</isNotEmpty> order by khzb.zbpx
    </select>  
    <select id="dn0.jgnjhglCount" parameterClass="java.util.Map" resultClass="java.lang.Integer"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select count(1) from ( select jh.khnf, jh.khdxdh, qx.jgdh, qx.jgmc, khzb.khzbmc, jh.jhz, jh.lzz,khzb.khzbdh from yjzb_jgnjh jh inner join khfa_khzb_jg khzb on jh.khzbdh=khzb.khzbdh inner join table(fn_getsjjg_java_qx($sysdate$, $login_khdxdh$, 0)) qx on qx.khdxdh=jh.khdxdh where 1=1 
      <isNotEmpty property="khnf">and jh.khnf =$khnf$</isNotEmpty>  
      <isNotEmpty property="khzbdh">and khzb.khzbdh=$khzbdh$</isNotEmpty>  
      <isNotEmpty property="jgkhdxdh">and qx.khdxdh in ($jgkhdxdh$)</isNotEmpty> order by khzb.zbpx ) t
    </select>  
    <select id="dn0.jgnjhgl_select_by_primaryKey" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select KHNF, LZZ, KHDXDH, KHZBDH, JHZ from YJZB_JGNJH where 1= 1 and KHNF = $khnf$ and KHDXDH = $khdxdh$ and KHZBDH = $khzbdh$
    </select>  
    <select id="dn0.jgnjhgl_check_insert" parameterClass="java.util.Map" resultClass="java.util.HashMap"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> select KHNF, LZZ, KHDXDH, KHZBDH, JHZ from YJZB_JGNJH where 1= 1 and KHNF = $jgnjh_nf$ and KHDXDH = $jgkhdxdh$ and KHZBDH = $KHZBDH$
    </select>  
    <insert id="dn0.jgnjhgl_insert" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> insert into YJZB_JGNJH( JHZ, KHNF, LZZ, KHZBDH, KHDXDH ) values ( $jgnjh_jhz$,$jgnjh_nf$,$jgnjh_lzz$,$KHZBDH$,$jgkhdxdh$)
    </insert>  
    <update id="dn0.jgnjhgl_update" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> update YJZB_JGNJH set JHZ = $jgnjh_jhz$,LZZ = $jgnjh_lzz$ where 1=1 and KHNF = $jgnjh_nf$ and KHDXDH = $jgkhdxdh$ and KHZBDH = $KHZBDH$
    </update>  
    <delete id="dn0.jgnjhgl_delete" parameterClass="java.util.Map"> 
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty> delete from YJZB_JGNJH where 1=1 and KHNF = $khnf$ and KHDXDH = $khdxdh$ and KHZBDH = $khzbdh$
    </delete> 
  </sqlMap>  
  <javascript> 
    <import>parent.addTab('jgnjhdr','机构年计划管理','/module/parser/import/visitHtml/jgnjhdr');</import>  
    <query>jQuery(document).ready(function () { jQuery("input[value='添 加']").hide(); jQuery("#exportBtn").show(); }); //自定义验证，在提交时执行。通过返回true，否则返回false function customValidate(){ return true; }</query>  
    <edit>jQuery(document).ready(function () { //这里的js脚本，会在页面加载完成后执行 $("#jgnjh_lzz").removeClass().addClass("{decimal:[21,4]}"); }); //自定义验证，在提交时执行。通过返回true，否则返回false function customValidate(){ if($("#jgnjh_lzz").val()==null ||$("#jgnjh_lzz").val()=='') { $("#jgnjh_lzz").val('null'); } return true; }</edit> 
  </javascript> 
</pageSetting>
