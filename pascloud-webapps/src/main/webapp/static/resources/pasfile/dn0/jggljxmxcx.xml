<?xml version="1.0" encoding="UTF-8"?>
<pageSetting id="jggljxmxcx" title="机构管理绩效明细查询" type="query" version="1.0.0.0" pid="" desc="标准版">
  <conPart>
    <tags>
      <tag row="0" col="0" colspan="1" rowspan="1" name="Date" label="统计日期">
        <attribute key="dateFmt" value="yyyyMMdd" />
        <attribute key="defValType" value="sysDate" />
        <attribute key="editable" value="true" />
        <attribute key="isRequired" value="true" />
        <attribute key="name" value="tjrq" />
        <attribute key="minDate" value="no" />
      </tag>
      <tag row="0" col="1" colspan="1" rowspan="1" name="NewMultipleHy" label="行员">
        <attribute key="isDisplayXN" value="true" />
        <attribute key="editable" value="true" />
        <attribute key="isRequired" value="false" />
        <attribute key="jgckbz" value="jg_ckhy" />
        <attribute key="name" value="khdxdh" />
        <attribute key="multiple" value="true" />
      </tag>
      <tag row="0" col="2" colspan="1" rowspan="1" name="MSQL4Select" label="行员类别">
        <attribute key="selectedList" value="1" />
        <attribute key="isMultiple" value="false" />
        <attribute key="width" value="120px;" />
        <attribute key="mulShowType" value="null" />
        <attribute key="key_SELECTTYPE" value="Integer" />
        <attribute key="isSearch" value="false" />
        <attribute key="sql" value="select lbdh as key, lbmc as value from csb_hylb " />
        <attribute key="isRequired" value="false" />
        <attribute key="name" value="hylb" />
        <attribute key="isAll" value="true" />
        <attribute key="isEditable" value="true" />
      </tag>
    </tags>
  </conPart>
  <table id="jggljxmxcx_xsjy1jgj" title="新数据源1结果集" page="true">
    <col id="TJRQ" title="统计日期" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="JGDH" title="机构代号" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="JGMC" title="机构名称" align="left" type="string" width="150" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="HYDH" title="行员代号" align="left" type="string" width="75" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="HYMC" title="行员名称" align="left" type="string" width="90" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="HYLB" title="行员类别" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="HYGW" title="行员岗位" align="left" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="KHJZGZ" title="考核基准工资" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="GWTJXS" title="岗位调节系数" align="right" type="string" width="120" frozen="false" format="###,##0.00" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="KHDF" title="机构考核得分" align="right" type="string" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="openWMX" />
    <col id="KZXS1" title="机构得分挂靠权重" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="GRKHDF" title="个人考核得分" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" xsType="href" onclick="openHYDFMX" />
    <col id="KZXS2" title="个人得分挂靠权重" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="YFGZ" title="应发机构管理绩效" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="SFGZ" title="实发机构管理绩效" align="right" type="float" width="120" frozen="false" format="" exp="true" zsy="true" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="GZFAMC" title="工资方案名称" align="left" type="hidden" width="120" frozen="false" format="" exp="false" zsy="false" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="KHDXDH" title="考核对象代号" align="left" type="hidden" width="120" frozen="false" format="" exp="false" zsy="false" showDymCol="false" mergeCells="false" footerCells="false" />
    <col id="GZXBH" title="工资项编号" align="left" type="hidden" width="120" frozen="false" format="" exp="false" zsy="false" showDymCol="" mergeCells="false" footerCells="false" />
    <col id="JGKHDXDH" title="机构考核对象代号" align="left" type="hidden" width="120" frozen="false" format="" exp="false" zsy="false" showDymCol="" mergeCells="false" footerCells="false" />
  </table>
  <sqlMap namespace="studio.jggljxmxcx">
    <select id="dn0.jggljxmxcxList" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select a.khdxdh, $tjrq$ as tjrq, c.jgdh, c.jgmc, b.hydh, b.hymc, d.lbmc as hylb, e.gwmc as hygw, a.khjzgz, cast (a.gwtjxs as decimal(19, 4)) as gwtjxs, cast(a.khdf as decimal(19, 2)) as khdf, round(a.yfgz, 2) yfgz, round(a.sfgz, 2) sfgz, a.gzfamc, a.gzxbh, c.khdxdh as jgkhdxdh,       a.grkhdf,a.kzxs1,a.kzxs2 from jxgz_jggljx a  inner join khdx_hy b on b.khdxdh=a.khdxdh  inner join khdx_jg c on c.jgdh=a.jgdh  inner join csb_hylb d on d.lbdh=a.hylb  inner join csb_hygw e on e.gwbh=a.hygw  inner join table(fn_getsjjg_java_qxhy($tjrq$, $login_khdxdh$, 0)) hy on hy.khdxdh=b.khdxdh
      <isNotEmpty property="khdxdh">where a.khdxdh in ($khdxdh$)</isNotEmpty>
      <isNotEmpty property="hylb">and a.hylb='$hylb$'</isNotEmpty>
      <isNotEmpty property="tjrq">and a.tjrq=$tjrq$</isNotEmpty>
      order by c.jgdh, b.hydh
    </select>
    <select id="dn0.jggljxmxcxCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
      <isNotEmpty property="db"><![CDATA[/**!mycat:datanode=$db$**/]]></isNotEmpty>
      select count(1) from ( select a.khdxdh, $tjrq$ as tjrq, c.jgdh, c.jgmc, b.hydh, b.hymc, d.lbmc as hylb, e.gwmc as hygw, a.khjzgz, cast (a.gwtjxs as decimal(19, 4)) as gwtjxs, cast(a.khdf as decimal(19, 2)) as khdf, round(a.yfgz, 2) yfgz, round(a.sfgz, 2) sfgz, a.gzfamc, a.gzxbh, c.khdxdh as jgkhdxdh,       a.grkhdf,a.kzxs1,a.kzxs2 from jxgz_jggljx a  inner join khdx_hy b on b.khdxdh=a.khdxdh  inner join khdx_jg c on c.jgdh=a.jgdh  inner join csb_hylb d on d.lbdh=a.hylb  inner join csb_hygw e on e.gwbh=a.hygw  inner join table(fn_getsjjg_java_qxhy($tjrq$, $login_khdxdh$, 0)) hy on hy.khdxdh=b.khdxdh
      <isNotEmpty property="khdxdh">where a.khdxdh in ($khdxdh$)</isNotEmpty>
      <isNotEmpty property="hylb">and a.hylb='$hylb$'</isNotEmpty>
      <isNotEmpty property="tjrq">and a.tjrq=$tjrq$</isNotEmpty>
      order by c.jgdh, b.hydh ) t
    </select>
    <select id="dn0.jggljxmxcx_MSQL4SELECT_hylb" parameterClass="java.util.Map" resultClass="java.util.HashMap" remapResults="true">/**!mycat:datanode=$db$**/ select lbdh as key, lbmc as value from csb_hylb</select>
  </sqlMap>
  <rels>
    <items id="jggljxmxcx_xsjy1jgj" />
  </rels>
  <javascript><![CDATA[jQuery(document).ready(function () {

});

//自定义验证，在提交时执行。通过返回true，否则返回false
function customValidate(){
 return true;
}
function openWMX(obj){  
    var pars = "{khdxdh:'"+obj['JGKHDXDH']+"',tjrq:'"+obj['TJRQ']+"',gzxbh:'"+obj['GZXBH']+"',yyzl:'"+2+"'}";
   //alert(pars);
    querySubQuery(pars,'jggzxzbjgcx','45','30','tag');

}

function openHYDFMX(obj){  
    var pars = "{khdxdh:'"+obj['KHDXDH']+"',tjrq:'"+obj['TJRQ']+"',gzxbh:'"+obj['GZXBH']+"',yyzl:'"+2+"'}";
   //alert(pars);
    querySubQuery(pars,'hygzxzbjgcx','45','30','tag');

}]]></javascript>
</pageSetting>

